
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="ko">
  <head>
    <meta charset="utf-8" />
    <title>TACO install - aio node &#8212; taco-aio-test  문서</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="index" title="색인" href="genindex.html" />
    <link rel="search" title="검색" href="search.html" />
    <link rel="prev" title="Welcome to taco-aio-test&#39;s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="taco-install-aio-node">
<h1>TACO install - aio node<a class="headerlink" href="#taco-install-aio-node" title="제목 주소">¶</a></h1>
<div class="section" id="tacoplay">
<h2>tacoplay 설정<a class="headerlink" href="#tacoplay" title="제목 주소">¶</a></h2>
<ul class="simple">
<li><p>Git 받아오기</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sudo yum install -y git
$ git clone https://github.com/openinfradev/tacoplay.git
$ <span class="nb">cd</span> tacoplay/
</pre></div>
</div>
<ul class="simple">
<li><p>하위 프로젝트 fetch</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ./fetch-sub-projects.sh
</pre></div>
</div>
<ul class="simple">
<li><p>ceph-ansible site.yml 생성</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ cp ceph-ansible/site.yml.sample ceph-ansible/site.yml
</pre></div>
</div>
<ul class="simple">
<li><p>extra-vars.yml 수정  (경로: tacoplay/inventory/sample)</p></li>
</ul>
<p>monitor_interface, public_network, cluster_network, ceph_monitors, lvm_molumes 확인 필요</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ vi inventory/sample/extra-vars.yml
&gt;
<span class="c1"># ceph</span>
monitor_interface: bond0
public_network: <span class="m">147</span>.75.93.0/24
cluster_network: <span class="m">147</span>.75.93.0/24
ceph_monitors: <span class="m">147</span>.75.93.27
</pre></div>
</div>
<p>lvm_volumes 설정을 통해 mount되어있지 않은 디스크를 ceph에서 사용할 수 있도록 한다.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ lsblk
 NAME    MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
 sda       <span class="m">8</span>:0    <span class="m">0</span> <span class="m">111</span>.8G  <span class="m">0</span> disk
 <span class="p">|</span>-sda1    <span class="m">8</span>:1    <span class="m">0</span>     2M  <span class="m">0</span> part
 <span class="p">|</span>-sda2    <span class="m">8</span>:2    <span class="m">0</span>   <span class="m">1</span>.9G  <span class="m">0</span> part <span class="o">[</span>SWAP<span class="o">]</span>
 <span class="sb">`</span>-sda3    <span class="m">8</span>:3    <span class="m">0</span> <span class="m">109</span>.9G  <span class="m">0</span> part /
 sdb       <span class="m">8</span>:16   <span class="m">0</span> <span class="m">111</span>.8G  <span class="m">0</span> disk           <span class="c1">#마운트 안되어 있으므로 사용 가능</span>
 nvme0n1 <span class="m">259</span>:0    <span class="m">0</span>   <span class="m">3</span>.5T  <span class="m">0</span> disk
</pre></div>
</div>
</div>
<div class="section" id="os">
<h2>OS 설정<a class="headerlink" href="#os" title="제목 주소">¶</a></h2>
<ul class="simple">
<li><p>호스트 파일 설정: admin 노드</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sudo vi /etc/hosts
<span class="c1">## TACO ClusterInfo</span>
<span class="m">127</span>.0.0.1   taco-aio
</pre></div>
</div>
</div>
<div class="section" id="taco">
<h2>TACO 설치<a class="headerlink" href="#taco" title="제목 주소">¶</a></h2>
<ul class="simple">
<li><p>TACO playbook 실행에 필요한 패키지 설치 : admin 노드</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># admin 노드에서 실행</span>
<span class="nb">cd</span> ~/tacoplay
sudo yum install -y selinux-policy-targeted
sudo yum install -y bridge-utils
sudo yum install -y epel-release
sudo yum install python-pip -y
sudo pip install --upgrade <span class="nv">pip</span><span class="o">==</span><span class="m">9</span>.0.3
sudo pip install -r ceph-ansible/requirements.txt
sudo pip install -r kubespray/requirements.txt --upgrade
sudo pip install -r requirements.txt --upgrade
</pre></div>
</div>
<ul class="simple">
<li><p>Taco 설치</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> ~/tacoplay
$ ansible-playbook -b -i inventory/sample/hosts.ini -e @inventory/sample/extra-vars.yml site.yml
</pre></div>
</div>
<p>ansible-playbook 옵션 설명
-i :  원하는 곳에 있는 inventory 를 타겟으로 설정
-e : 실행시간에 변수 값 전달 가능</p>
</div>
<div class="section" id="id1">
<h2>TACO 설치 확인<a class="headerlink" href="#id1" title="제목 주소">¶</a></h2>
<ul class="simple">
<li><p>Network 설정</p></li>
</ul>
<p>br-ex 인터페이스 up 시키고, nat 룰을 추가한다</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> ~/tacoplay
$ ./scripts/init-network.sh
</pre></div>
</div>
<ul class="simple">
<li><p>Key 생성</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ssh-keygen -t rsa
</pre></div>
</div>
<ul class="simple">
<li><p>설치 확인</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> ~/tacoplay
$ tests/taco-test.sh
</pre></div>
</div>
</div>
<div class="section" id="trouble-shoothing">
<h2>Trouble Shoothing<a class="headerlink" href="#trouble-shoothing" title="제목 주소">¶</a></h2>
<ul class="simple">
<li><p>Missing value auth-url required for auth plugin password</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ . tacoplay/scripts/adminrc
</pre></div>
</div>
</div>
<div class="section" id="vm">
<h2>VM 생성 후<a class="headerlink" href="#vm" title="제목 주소">¶</a></h2>
<ul class="simple">
<li><p>생성된 VM 확인</p></li>
</ul>
<p>다음과 같은 명령어로 taco-test 스크립트를 돌려 생성된 VM을 확인할 수 있다.
결과 Networks 란에서 생성된 VM 의 ip 주소를 확인한다.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ openstack server list

&gt; 결과
+--------------------------------------+------+--------+------------------------------------+--------------+---------+
<span class="p">|</span> ID                                   <span class="p">|</span> Name <span class="p">|</span> Status <span class="p">|</span> Networks                           <span class="p">|</span> Image        <span class="p">|</span> Flavor  <span class="p">|</span>
+--------------------------------------+------+--------+------------------------------------+--------------+---------+
<span class="p">|</span> 4dd41f3c-f230-4100-aaaf-3c58cc942463 <span class="p">|</span> <span class="nb">test</span> <span class="p">|</span> ACTIVE <span class="p">|</span> private-net<span class="o">=</span><span class="m">172</span>.30.1.7, <span class="m">10</span>.10.10.3 <span class="p">|</span> Cirros-0.4.0 <span class="p">|</span> m1.tiny <span class="p">|</span>
+--------------------------------------+------+--------+------------------------------------+--------------+---------+
</pre></div>
</div>
<ul class="simple">
<li><p>생성된 VM에 접속, 외부 통신 확인</p></li>
</ul>
<p>ssh로 VM 에 접속 후, 네트워크 접속 상태를 확인하기 위해 ping 테스트를 수행한다. ( 8.8.8.8 은 구글 퍼블릭 DNS ip주소)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>root@taco-aio ~<span class="o">]</span><span class="c1"># ssh cirros@10.10.10.3    #생성된 VM의 ip주소를 넣는다.</span>
$ ping <span class="m">8</span>.8.8.8
PING <span class="m">8</span>.8.8.8 <span class="o">(</span><span class="m">8</span>.8.8.8<span class="o">)</span>: <span class="m">56</span> data bytes
<span class="m">64</span> bytes from <span class="m">8</span>.8.8.8: <span class="nv">seq</span><span class="o">=</span><span class="m">0</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">53</span> <span class="nv">time</span><span class="o">=</span><span class="m">1</span>.638 ms
<span class="m">64</span> bytes from <span class="m">8</span>.8.8.8: <span class="nv">seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">53</span> <span class="nv">time</span><span class="o">=</span><span class="m">1</span>.498 ms
<span class="m">64</span> bytes from <span class="m">8</span>.8.8.8: <span class="nv">seq</span><span class="o">=</span><span class="m">2</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">53</span> <span class="nv">time</span><span class="o">=</span><span class="m">1</span>.147 ms
<span class="m">64</span> bytes from <span class="m">8</span>.8.8.8: <span class="nv">seq</span><span class="o">=</span><span class="m">3</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">53</span> <span class="nv">time</span><span class="o">=</span><span class="m">1</span>.135 ms
<span class="m">64</span> bytes from <span class="m">8</span>.8.8.8: <span class="nv">seq</span><span class="o">=</span><span class="m">4</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">53</span> <span class="nv">time</span><span class="o">=</span><span class="m">1</span>.237 ms
</pre></div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">taco-aio-test</a></h1>








<h3>탐색</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">TACO install - aio node</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tacoplay">tacoplay 설정</a></li>
<li class="toctree-l2"><a class="reference internal" href="#os">OS 설정</a></li>
<li class="toctree-l2"><a class="reference internal" href="#taco">TACO 설치</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">TACO 설치 확인</a></li>
<li class="toctree-l2"><a class="reference internal" href="#trouble-shoothing">Trouble Shoothing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vm">VM 생성 후</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="이전 장">Welcome to taco-aio-test's documentation!</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>빠른 검색</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="이동" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, jimin.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/taco-aio.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>